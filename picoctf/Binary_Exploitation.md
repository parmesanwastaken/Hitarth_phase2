# 1. buffer overflow 0

> Let's start off simple, can you overflow the correct buffer? The program is available here. You can view source here. Additional details will be available after launching your challenge instance.

## Solution:

- I installed both files and decided the `cat` the source code
- It called a `flag.txt` and made use of various functions, including `gets` and `fgets`
- The hint mentioned to check `man` page of `gets`, so I did that and figured it has memory issues and easily gets overflowed
- Checked the source code more properly and saw `buf1` had 100 limit
- The `input` didn't have any limit, so I decided to just smash my keyboard and enter lot of characters

```
Input: fgdfkngdkfngkjdfngkjdfngkdjnfgdkfjgkdjfngkdjnfgkjdnfgjdkfjngkdjfngkdfgkdfkgjndfkgndfgjndkfjngkdfngkdfkgjdfjngkdjfgkjdnfgndkfjngkdjnfkgjndfjngkdjnfgkjndfjngdkfngdjfgkdfngkdjfnkgjdnfkgjndfkgjndkfngdkjfngkdnfgjndfgjnfjndslsf
```
- This printed the flag

## Flag:

```
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```

## Concepts learnt:

- I learnt a bit about how stack and buffer overflow work

## Notes:

- Went through attatched videos and website in Phase 2 PDF, but none of them made any sense ;-;
- Simply reading source code did help a lot tho, and thus I was able to get the flag

## Resources:

- [Stack intro](https://youtube.com/watch?v=CRTR5ljBjPM)
- [CTF101- Binary exploitation](https://ctf101.org/binary-exploitation/overview/)


***

# 2. format string 0

> Can you use your knowledge of format strings to make the customers happy? Download the binary here. Download the source here. Additional details will be available after launching your challenge instance.

## Solution:

```bash
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Gr%114d_Cheese
Gr                                                                                                           4202954_Cheese
Good job! Patrick is happy! Now can you serve the second customer?
Sponge Bob wants something outrageous that would break the shop (better be served quick before the shop owner kicks you out!)
Please choose from the following burgers: Pe%to_Portobello, $outhwest_Burger, Cla%sic_Che%s%steak
Enter your recommendation: Cla%sic_Che%s%steak
ClaCla%sic_Che%s%steakic_Che(null)
```
- First I used `cat` to check the source code of file and read a bit through it
- Now I had idea that I will have to choose 2 orders and understand the source code to exploit these and get the flag
- At first I read Patrick part and realised if I choose wrong string then I am asked to give something else cause he is still hungry.
- So I decided to give him the largest option, which was `Gr%114d_Cheese` cause of `%114d` which infaltes the character amount.
- Now that this was done, I was asked to give order to Sponge Bob
- The options `Cla%sic_Che%s%steak` has lot of `%s` with no input for it, which lead to program getting crashed
- Thus it printed the flag

## Flag:

```
picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_a1d85b3e}
```

## Concepts learnt:

- Learnt how different functions and syntaxes in C can be exploited to act differently and thus take advantage of program to give output it isn't supposed to

## Notes:

- At first I got confused what to choose when I was given options, but inspecting source code helped me!

## Resources:

- Few searches regarding how some syntaxes work


***

# 3. clutter-overflow

> Clutter, clutter everywhere and not a byte to use. `nc mars.picoctf.net 31890`

## Solution:

- I installed both the files to see the source code and mess with program locally
- The program uses `gets()` so we can overflow it and exploit
- The max size is `0x100` which is `256` bytes, so we must use value more than this.
- First I inputted random strings after connecting to netcat, but it always said `0x0` bytes whereas we actually need `0xdeadbeef`
- Now I understood that we must overflow the `gets` and append exactly the amount of bytes so that it appends them to next thing in stack and thus give me the flag
- This part was the most complex
- I opened the file in IDA and realised we actually need `256+8` bytes for overflowing
- We can't append `0xdeadbeef` directly, so we need to write it using little-endian, which writes in reverse order. Thus we write it as `\xef\xbe\xad\xde`
- Now that we know this, we can create a simple python snippet to get the flag: `python3 -c "import sys; sys.stdout.buffer.write(b'A'*264 + b'\xef\xbe\xad\xde\n')" | nc mars.picoctf.net 31890`
- This gives us the flag

## Flag:

```
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
```

## Concepts learnt:

- Learnt a lot on how exactly to figure the amount needed for overflow
- How to actually do buffer overflow
- How to use little endian

## Notes:

- I got stuck almost on every step at first, it was pretty easy to figure out what to do i.e just overflow and append bytes to interpret them as deadbeef
- First I had to understand that computers need to use little endian, thus I converted deadbeef to that
- I also tried using gdb, but that didn't work for me
- I even tried gef instead to get verbose output and use other commands to create exploit, but didn't work for me either
- Thankfully IDA worked at last o figure out we actually need `264` bytes for overflow

## Resources:

- [Info on little endian](https://en.wikipedia.org/wiki/Endianness)
- IDA
- `man gets`
