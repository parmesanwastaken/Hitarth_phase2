# 1. Cookies

> Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:64944/

## Solution:

- First opened the website and looked around a bit.
- The title made it pretty obvi that I had to mess with cookies
- I opened dev panel > storage > cookies
- Now that I can see cookie values, I decided to put `snickerdoodle` as first input, which was hinted on the input box itself
- This switched cookie value from `-1` to `0` and prompted that this is a valid cookie but not special one
- So I decided to enter random numbers, first I changed cookie value to `999`, this wasn't valid so I decided to switch it to `100`, which was't valid either
- Kept cutting down, until I realised max valid value was `28`, but that didn't have anything useful either.
- So I went chronologically from `0`
- Finally the value `18` gave me the valid flag

## Flag:

```
picoCTF{3v3ry1_l0v3s_c00k135_cc9110ba}
```

## Concepts learnt:

- I learnt how to mess with cookies and change its value and thus exploit unsecure cookies on websites.

## Notes:

- I tried some random strings such as `admin` when I realised `28` was last valid cookie and still didn't give anything.

## Resources:

- None


***

# 2. Web Gauntlet

> Can you beat the filters?

Additional details will be available after launching your challenge instance.

## Solution:

- First I launched the instance and was given 2 websites
- First one had username and password field and second one was `/filter.php`
- Hints made it obvious it is SQL injection (sqlite was used specifically)
- There were 5 rounds and for some reason basic `' OR 1=1 --` didn't work :(
- So I looked up and found a cheat sheat (basic sql injection syntaxes) on `portswigger.net`
- Also whnever I entered random string in input box it showed `SELECT * FROM users WHERE username=''' AND password='''`
- Then I realised I can just login as `admin` by putting `admin' --` instead of using `OR`
- For second round I realised that `/filter.php` actually showed me filtered keywords lol, as `--` didn't work anymore
- So I opened the cheat sheat and it showed me another way to comment using `/*`, which worked
- In third round all comments were filtered so I reopned cheat sheat and figured I can use `;` to terminate statements
- Thus using `admin' ;` worked
- Now even `admin` was blocked
- There is a way to bypass this easily by just using `||` to seperate a string
- Thus `a'||'dmin';` worked
- Final round removed `UNION` and I have no idea how to do `UNION` attacks. It didn't block `||` so I was still able to use it.

## Flag:

```
picoCTF{y0u_m4d3_1t_79a0ddc6}
```

## Concepts learnt:

- Learnt a bit more about SQL basics and how to use different comment statements or seperate strings and break statements

## Notes:

- Made ton of mistakes like using filtered things in my SQL injection input and trying random methods like time delay or `CONCAT`

## Resources:

- [Bible](https://portswigger.net/web-security/sql-injection/cheat-sheet) for this challenge


***

# 3. SSTI1

> I made a cool website where you can announce whatever you want! Try it out! Additional details will be available after launching your challenge instance.

## Solution:

- First I created a new instance
- There was an input box and I tried inputting random strings, this gave me nothing
- The challenge name and hint on picoctf clearly stated it was a server side template injection attack
- I had no clue about this so I searched around a bit
- Found an article which stated different templates and how to figure out which one the website is using to exploit it
- Realised that challenge website is using Jinja2, so searched more on exploits about it on web
- Found a github link with severity score of 10/10 with title `Server Side Template Injection in Jinja2 allows Remote Command Execution`
- Now I knew I can execute shell commands on website using following from POC: `{{ self.__init__.__globals__.__builtins__.__import__('os').popen('<command here>').read() }}`
- First I used `{{ self.__init__.__globals__.__builtins__.__import__('os').popen('ls').read() }}` , this gave me all the files inside directory
- Then I found out a file called `flag`
- So I used `{{ self.__init__.__globals__.__builtins__.__import__('os').popen('cat flag').read() }}`
- This gave me the flag

## Flag:

```
picoCTF{s4rv3r_s1d3_t3mp14t3_1nj3ct10n5_4r3_c001_dcdca99a}
```

## Concepts learnt:

- I learnt about SSTI attack and how I can create payloads to find root users or read files hidden inside webserver. Basically learnt about a very easy to execute RCE exploit on `<= 0.45.20` Jinja2.

## Notes:

- This was kind of hard for me at first, as I didn't have SSTI knowledge beforehand. After finding some medium articles and vulnerablities online, it became easier to understand and execute
- Did a lotta mistakes at first too like injecting older vulnerablities or vulns from other templates. Then realised first I should figure out which template it is and then exploit it using recent CVEs (glad finding CVE part was easy)

## Resources:

- Referred [this](https://medium.com/@bootstrapsecurity/server-side-template-injection-ssti-advanced-exploitation-techniques-2d8ccdf6270f) medium article for figuring out template engine (thank you archive.is team for helping me bypass paywall lol)
- [This](https://github.com/dgtlmoon/changedetection.io/security/advisories/GHSA-4r7v-whpg-8rx3) is the CVE on github that I referred (CVE ID: CVE-2024-32651)


***



